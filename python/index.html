<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Speed Test</title>
</head>
<body>
    <h1>Typing Speed Test</h1>
    <p id="sentence">Loading sentence...</p>
    <textarea id="user-input" placeholder="Type the sentence here"></textarea>
    <p id="result"></p>
    <button id="start-button">Start Game</button>

    <script>
        const startButton = document.getElementById("start-button");
        const sentenceElement = document.getElementById("sentence");
        const userInput = document.getElementById("user-input");
        const resultElement = document.getElementById("result");

        async function fetchSentence() {
            const response = await fetch('/get_sentence');
            const data = await response.json();
            return data.sentence;
        }

        startButton.addEventListener('click', async () => {
            startButton.disabled = true;
            userInput.value = "";
            resultElement.textContent = "";

            const sentence = await fetchSentence();
            sentenceElement.textContent = sentence;

            const startTime = new Date().getTime();

            userInput.addEventListener('input', function checkInput() {
                if (userInput.value === sentence) {
                    const endTime = new Date().getTime();
                    const timeInSeconds = (endTime - startTime) / 1000;
                    const words = sentence.split(' ').length;
                    const typingSpeed = (words / timeInSeconds) * 60;
                    resultElement.textContent = `Typing Speed: ${typingSpeed.toFixed(2)} words per minute`;

                    // Enable the start button for the next round
                    startButton.disabled = false;
                }
            });
        });
    </script>
</body>
</html>
